<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
	<title>Ameisen</title>
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
	
	<link rel="stylesheet" media="screen" href="css/reset.css"/>
	<link rel="stylesheet" media="screen" href="css/style.css"/>
</head>

<body>
	<div id="canvasWrapper">
		<canvas id="connector">

		</canvas>
		<canvas id="canvas">
			Canvas kann nicht dargestellt werden
		</canvas>
	</div>

	<div class="draggable">
		<div class="handle">Chambers
		</div>
				<table class="chamberTable" id="broodBuild">
			<tr>
				<th class="chamberName" colspan="2">Brood Chamber</th>
			</tr>
			<tr>
				<td>Leafs</td>
				<td class="buildCostLeafs">1502313</td>
			</tr>
			<tr>
				<td>Stone</td>
				<td class="buildCostStone">12011</td>
			</tr>
			<tr>
				<td></td>
				<td><button class="build">Build</button></td>
			</tr>
		</table>
		
		<table class="chamberTable" id="mushroomBuild">
			<tr>
				<th class="chamberName" colspan="2">Mushroom Chamber</th>
			</tr>
			<tr>
				<td>Leafs</td>
				<td class="buildCostLeafs">1502313</td>
			</tr>
			<tr>
				<td>Stone</td>
				<td class="buildCostStone">12011</td>
			</tr>
			<tr>
				<td></td>
				<td><button class="build">Build</button></td>
			</tr>
		</table>

		<table class="chamberTable"  id="storageBuild">	
			<tr>
				<th class="chamberName" colspan="2">Storage</th>
			</tr>
			<tr>
				<td>Leafs</td>
				<td class="buildCostLeafs">1502313</td>
			</tr>
			<tr>
				<td>Stone</td>
				<td class="buildCostStone">12011</td>
			</tr>
			<tr>
				<td></td>
				<td><button class="build">Build</button></td>
			</tr>
		</table>

		<table class="chamberTable"  id="pantryBuild">
			<tr>
				<th class="chamberName" colspan="2">Pantry</th>
			</tr>
			<tr>
				<td>Leafs</td>
				<td class="buildCostLeafs">1502313</td>
			</tr>
			<tr>
				<td>Stone</td>
				<td class="buildCostStone">12011</td>		
			</tr>
			<tr>
				<td></td>
				<td><button class="build">Build</button></td>
			</tr>
		</table>
		<table class="chamberTable" id="dumpingBuild">
			<tr>
				<th class="chamberName" colspan="2">Dumping Ground</th>
			</tr>
			<tr>
				<td>Leafs</td>
				<td class="buildCostLeafs">1502313</td>
			</tr>
			<tr>
				<td>Stone</td>
				<td class="buildCostStone">12011</td>
			</tr>
			<tr>
				<td></td>
				<td><button class="build">Build</button></td>
			</tr>
		</table>
	</div>

	<div class="draggable">
	  <div class="handle">Jobs</div>
	  <table id="jobTable">
	  	<tr>
	  		<td class="jobName">Collect Leafs</td>
	  		<td><button id="btn_subJobL">-</button></td>
		  	<td class="jobCount" id="jobCountL"><span>0</span></td>
		  	<td><button id="btn_addJobL">+</button></td>
	  	</tr>
	  	<tr>
	  		<td class="jobName">Collect Stone</td>
	  		<td><button id="btn_subJobS">-</button></td>
		  	<td class="jobCount" id="jobCountS"><span>0</span></td>
		  	<td><button id="btn_addJobS">+</button></td>
	  	</tr>
	  	<tr>
	  		<td class="jobName">Hunt</td>
	  		<td><button id="btn_subJobHu">-</button></td>
		  	<td class="jobCount" id="jobCountHu"><span>0</span></td>
		  	<td><button id="btn_addJobHu">+</button></td>
	  	</tr>
	  	<tr>
	  		<td class="jobName">Hatch</td>
	  		<td><button id="btn_subJobHa">-</button></td>
		  	<td class="jobCount" id="jobCountHa"><span>0</span></td>
		  	<td><button id="btn_addJobHa">+</button></td>
	  	</tr>	  	
	  	<tr>
	  		<td class="jobName">Clean</td>
	  		<td><button id="btn_subJobC">-</button></td>
		  	<td class="jobCount" id="jobCountC"><span>0</span></td>
		  	<td><button id="btn_addJobC">+</button></td>
	  	</tr>
	  </table>
	</div>


	<div class="draggable" id="dxy">
		<div class="handle"></div>
		<table id="resTable">
			<tr>
				<th>Leafs:</th>
				<th>Stone:</th>
				<th>Food:</th>
				<th>Amber:</th>
			</tr>
			<tr>
				<td id="leafCount"><span>xxx</span></td>
				<td id="stoneCount"><span>xxx</span></td>
				<td id="foodCount"><span>xxx</span></td>
				<td id="amberCount"><span>xxx</span></td>
			</tr>
		</table>
	</div>


	<!-- Lightbox Gebäude Click -->
	<div id="buildingView" class="lightboxWrapper">
		<div class="lightboxContent">
			<!-- Name des Gebäudes -->
			<h1 id="buildingViewTitle">
				Building
			</h1>
			<img id="buildingViewImage">

			<form id="buildingViewForm">
				<p id="buildingViewTextUpgrade">
				<input type="text" placeholder="Gruppen Name" name="groupName" maxlength="6" required>
				<div class="row">
					<button>Upgrade</button>
				</div>
				<div class="row">
					<a href="#closeLightBox">Schließen</a>
				</div>
			</form>
		</div>
	</div>
	<a id="closeLightbox" href="#closeLightbox"></a>




	<!--
		Notwendige Javascript Datein
	-->
	<script type="text/javascript" src="js/helpFunctions.js"></script>
	<script type="text/javascript" src="js/plugins/zim_1.3.js"></script>
	<script type="text/javascript" src="js/plugins/createjs-2015.05.21.min.js"></script>

	<script type="text/javascript" src="js/ameisen/stage.js"></script>
	<script type="text/javascript" src="js/ameisen/canvas.js"></script>
	<script type="text/javascript" src="js/ameisen/test.js"></script>
	
	<!--
		Spiel erstellen
	-->
	<script type="text/javascript" src="js/init.js"></script>
<script>
window.onload = addListeners();
	

function addListeners(){
	var bars = document.querySelectorAll(".handle");

	for (var i = bars.length - 1; i >= 0; i--) {
		new menuBarDragger(bars[i]);
	};
}

function menuBarDragger (ele) {
	var offsetLeft = 0;
	var offsetTop = 0;
	var timerId = null;
	var click = {
		x : null,
		y : null
	};

	(function init() {
		ele.parentNode.style.position = 'absolute';

		ele.addEventListener('mousedown', mouseDown, false);
		window.addEventListener('mouseup', mouseUp, false);
	})();

	function mouseUp()
	{
	    window.removeEventListener('mousemove', newMousePos, true);
	    if(timerId != null){
	    	window.cancelAnimationFrame(timerId);
	  		timerId = null;
	    }
	}

	function mouseDown(e){
	  offsetTop = (ele.parentNode.offsetTop - e.clientY );
	  offsetLeft = (ele.parentNode.offsetLeft - e.clientX ) ;
	  newMousePos(e);

	  timerId = window.requestAnimationFrame(divMove);
	  window.addEventListener('mousemove', newMousePos, true);
	}

	function newMousePos(e) {
		click.x = e.clientX;
  		click.y = e.clientY;

  		// Kein Makieren von Texten bei Bewegung
  		e.preventDefault();
	}

	function divMove(){
		var values = {
			x: 0,
			y: 0
		};

		// Oben angeschlagen 
		if(click.y + offsetTop <= 0) {
			values.y = 0
		}
		// Unten angeschlagen
		else if ( (window.innerHeight - (click.y + offsetTop + ele.parentNode.offsetHeight)) <= 0){
			values.y = window.innerHeight - ele.parentNode.offsetHeight;
		}
		else {
			values.y = (click.y + offsetTop);
		}

		// Links angeschlagen
		if(click.x + offsetLeft <= 0){
			values.x = 0;
		}
		// Rechts angeschlagen
		else if( (window.innerWidth - (click.x + offsetLeft + ele.parentNode.offsetWidth)) <= 0 ){
			values.x = window.innerWidth - ele.parentNode.offsetWidth;
		}
		else {
			values.x = (click.x + offsetLeft);
		}


		ele.parentNode.style.top = values.y + 'px';
		ele.parentNode.style.left = values.x + 'px';


		timerId = window.requestAnimationFrame(divMove);
	}
}
	</script>	
</body>
</html>